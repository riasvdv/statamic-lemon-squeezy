(()=>{"use strict";var e=function(e,t,o,s,r,n,i,a){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=o,u._compiled=!0),s&&(u.functional=!0),n&&(u._scopeId="data-v-"+n),i?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},u._ssrRegister=l):r&&(l=a?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var d=u.render;u.render=function(e,t){return l.call(t),d(e,t)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,l):[l]}return{exports:e,options:u}}({mixins:[Fieldtype],data:function(){return{error:null,stores:[],products:[],isLoadingStores:!0,isLoadingProducts:!0}},created:function(){this.value||(this.value={store:null,product:null,buttonText:null,overlay:!1})},mounted:function(){var e=this;this.isLoadingStores=!0,fetch(cp_url("/lemon-squeezy/api/stores")).then((function(e){return e.json()})).then((function(t){if(e.isLoadingStores=!1,t.error)e.error=t.error;else if(e.stores=t,t.length){var o=t.findIndex((function(t){return t.value===e.value.store}));-1===o&&(o=0),e.value.store=t[o].value,e.getProducts(t[o].value)}}))},watch:{"value.store":function(e){this.value.product=null,this.getProducts(e)},value:{deep:!0,handler:function(e){this.update(e)}}},methods:{getProducts:function(e){var t=this;return this.products=[],this.isLoadingProducts=!0,fetch(cp_url("/lemon-squeezy/api/products?store_id="+e)).then((function(e){return e.json()})).then((function(e){if(e.error)t.error=e.error;else if(t.products=e,e.length){var o=e.findIndex((function(e){return e.value===t.value.product}));-1===o&&(o=0),t.value.product=e[o].value}})).finally((function(){t.isLoadingProducts=!1}))}}},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("fieldset",{staticClass:"flex flex-col gap-2 border-grey-40 px-2 py-2 rounded m-0 relative"},[o("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoadingStores&&!e.error&&e.stores.length>1,expression:"!isLoadingStores && !error && stores.length > 1"}]},[o("label",{staticClass:"publish-field-label"},[e._v("Store")]),e._v(" "),o("select-input",{attrs:{options:e.stores},model:{value:e.value.store,callback:function(t){e.$set(e.value,"store",t)},expression:"value.store"}})],1),e._v(" "),o("div",[o("label",{staticClass:"publish-field-label"},[e._v("Product")]),e._v(" "),o("select-input",{directives:[{name:"show",rawName:"v-show",value:!e.isLoadingProducts&&e.products.length>0,expression:"!isLoadingProducts && products.length > 0"}],attrs:{options:e.products},model:{value:e.value.product,callback:function(t){e.$set(e.value,"product",t)},expression:"value.product"}}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.isLoadingStores,expression:"isLoadingStores"}]},[o("small",[e._v("Loading stores...")])]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoadingStores&&e.isLoadingProducts,expression:"!isLoadingStores && isLoadingProducts"}]},[o("small",[e._v("Loading your products...")])]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoadingProducts&&0===e.products.length,expression:"!isLoadingProducts && products.length === 0"}]},[o("small",[e._v("No products found...")])])],1),e._v(" "),o("div",[o("label",{staticClass:"publish-field-label"},[e._v("Button text")]),e._v(" "),o("text-input",{model:{value:e.value.buttonText,callback:function(t){e.$set(e.value,"buttonText",t)},expression:"value.buttonText"}})],1),e._v(" "),o("div",[o("label",{staticClass:"publish-field-label"},[e._v("Use checkout overlay?")]),e._v(" "),o("toggle-input",{model:{value:e.value.overlay,callback:function(t){e.$set(e.value,"overlay",t)},expression:"value.overlay"}}),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.value.overlay,expression:"value.overlay"}],staticClass:"text-grey text-sm"},[e._v("Your checkout will be opened in a modal window.")]),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:!e.value.overlay,expression:"!value.overlay"}],staticClass:"text-grey text-sm"},[e._v("Your customer will be redirected to your checkout page.")])],1),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}]},[o("small",{staticClass:"text-red"},[e._v("Error: "+e._s(e.error))])])])}),[],!1,null,null,null);const t=e.exports;Statamic.booting((function(){Statamic.component("lemon_squeezy-fieldtype",t)}))})();
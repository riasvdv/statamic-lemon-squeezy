(()=>{"use strict";var e=function(e,t,s,o,i,a,l,r){var n,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=s,u._compiled=!0),o&&(u.functional=!0),a&&(u._scopeId="data-v-"+a),l?(n=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(l)},u._ssrRegister=n):i&&(n=r?function(){i.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:i),n)if(u.functional){u._injectStyles=n;var c=u.render;u.render=function(e,t){return n.call(t),c(e,t)}}else{var v=u.beforeCreate;u.beforeCreate=v?[].concat(v,n):[n]}return{exports:e,options:u}}({mixins:[Fieldtype],data:function(){return{error:null,stores:[],products:[],isLoadingStores:!0,isLoadingProducts:!0}},created:function(){this.value||(this.value={store:null,product:null,buttonText:null,overlay:!1,showStoreLogo:!0,showMedia:!0,showDescription:!0,showDiscountCode:!0}),void 0===this.value.showStoreLogo&&(this.value.showStoreLogo=!0),void 0===this.value.showMedia&&(this.value.showMedia=!0),void 0===this.value.showDescription&&(this.value.showDescription=!0),void 0===this.value.showDiscountCode&&(this.value.showDiscountCode=!0)},mounted:function(){var e=this;this.isLoadingStores=!0,fetch(cp_url("/lemon-squeezy/api/stores")).then((function(e){return e.json()})).then((function(t){if(e.isLoadingStores=!1,t.error)e.error=t.error;else if(e.stores=t,t.length){var s=t.findIndex((function(t){return t.value===e.value.store}));-1===s&&(s=0),e.value.store=t[s].value,e.getProducts(t[s].value)}}))},watch:{"value.store":function(e){this.value.product=null,this.getProducts(e)},value:{deep:!0,handler:function(e){this.update(e)}}},methods:{getProducts:function(e){var t=this;return this.products=[],this.isLoadingProducts=!0,fetch(cp_url("/lemon-squeezy/api/products?store_id="+e)).then((function(e){return e.json()})).then((function(e){if(e.error)t.error=e.error;else if(t.products=e,e.length){var s=e.findIndex((function(e){return e.value===t.value.product}));-1===s&&(s=0),t.value.product=e[s].value}})).finally((function(){t.isLoadingProducts=!1}))}}},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("fieldset",{staticClass:"flex flex-col gap-2 border-grey-40 rounded m-0 relative"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoadingStores&&!e.error&&e.stores.length>1,expression:"!isLoadingStores && !error && stores.length > 1"}],staticClass:"field-inner"},[s("label",{staticClass:"publish-field-label"},[e._v("Store")]),e._v(" "),s("select-input",{attrs:{options:e.stores},model:{value:e.value.store,callback:function(t){e.$set(e.value,"store",t)},expression:"value.store"}})],1),e._v(" "),s("div",{staticClass:"field-inner"},[s("label",{staticClass:"publish-field-label"},[e._v("Product")]),e._v(" "),s("select-input",{directives:[{name:"show",rawName:"v-show",value:!e.isLoadingProducts&&e.products.length>0,expression:"!isLoadingProducts && products.length > 0"}],attrs:{options:e.products},model:{value:e.value.product,callback:function(t){e.$set(e.value,"product",t)},expression:"value.product"}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isLoadingStores,expression:"isLoadingStores"}]},[s("small",[e._v("Loading stores...")])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoadingStores&&e.isLoadingProducts,expression:"!isLoadingStores && isLoadingProducts"}]},[s("small",[e._v("Loading your products...")])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoadingProducts&&0===e.products.length,expression:"!isLoadingProducts && products.length === 0"}]},[s("small",[e._v("No products found...")])])],1),e._v(" "),s("div",{staticClass:"field-inner"},[s("label",{staticClass:"publish-field-label"},[e._v("Button text")]),e._v(" "),s("text-input",{model:{value:e.value.buttonText,callback:function(t){e.$set(e.value,"buttonText",t)},expression:"value.buttonText"}})],1),e._v(" "),s("div",{staticClass:"field-inner"},[s("label",{staticClass:"publish-field-label"},[e._v("Use checkout overlay?")]),e._v(" "),s("div",{staticClass:"flex items-center gap-2"},[s("toggle-input",{model:{value:e.value.overlay,callback:function(t){e.$set(e.value,"overlay",t)},expression:"value.overlay"}}),e._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:e.value.overlay,expression:"value.overlay"}],staticClass:"text-grey text-sm"},[e._v("Your checkout will be opened in a modal window.")]),e._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:!e.value.overlay,expression:"!value.overlay"}],staticClass:"text-grey text-sm"},[e._v("Your customer will be redirected to your checkout page.")])],1)]),e._v(" "),s("div",{staticClass:"flex gap-2 items-center"},[s("label",{staticClass:"publish-field-label"},[e._v("Show store logo")]),e._v(" "),s("toggle-input",{model:{value:e.value.showStoreLogo,callback:function(t){e.$set(e.value,"showStoreLogo",t)},expression:"value.showStoreLogo"}})],1),e._v(" "),s("div",{staticClass:"flex gap-2 items-center"},[s("label",{staticClass:"publish-field-label"},[e._v("Show product media")]),e._v(" "),s("toggle-input",{model:{value:e.value.showMedia,callback:function(t){e.$set(e.value,"showMedia",t)},expression:"value.showMedia"}})],1),e._v(" "),s("div",{staticClass:"flex gap-2 items-center"},[s("label",{staticClass:"publish-field-label"},[e._v("Show product description")]),e._v(" "),s("toggle-input",{model:{value:e.value.showDescription,callback:function(t){e.$set(e.value,"showDescription",t)},expression:"value.showDescription"}})],1),e._v(" "),s("div",{staticClass:"flex gap-2 items-center"},[s("label",{staticClass:"publish-field-label"},[e._v("Show discount code")]),e._v(" "),s("toggle-input",{model:{value:e.value.showDiscountCode,callback:function(t){e.$set(e.value,"showDiscountCode",t)},expression:"value.showDiscountCode"}})],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}]},[s("small",{staticClass:"text-red"},[e._v("Error: "+e._s(e.error))])])])}),[],!1,null,null,null);const t=e.exports;Statamic.booting((function(){Statamic.component("lemon_squeezy-fieldtype",t)}))})();